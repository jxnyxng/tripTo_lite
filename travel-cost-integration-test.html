<!DOCTYPE html>
<html>
<head>
    <title>TripTo Lite - Travel Cost Integration Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        .section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 5px; }
        button { padding: 10px 20px; margin: 5px; background: #007cba; color: white; border: none; cursor: pointer; border-radius: 3px; }
        button:hover { background: #005a84; }
        .result { background: #f5f5f5; padding: 15px; margin: 10px 0; border-left: 4px solid #007cba; white-space: pre-wrap; font-family: monospace; }
        input, select { padding: 8px; margin: 5px; border: 1px solid #ddd; border-radius: 3px; }
        .status-ok { color: green; font-weight: bold; }
        .status-error { color: red; font-weight: bold; }
        .api-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ TripTo Lite - Travel Cost Integration Test</h1>
        
        <div class="section">
            <h2>ğŸ”Œ API ì„œë²„ ìƒíƒœ í™•ì¸</h2>
            <button onclick="checkTravelCostStatus()">Travel Cost API ìƒíƒœ í™•ì¸</button>
            <button onclick="checkMainServerStatus()">ë©”ì¸ ì„œë²„ ìƒíƒœ í™•ì¸</button>
            <div id="status-result" class="result"></div>
        </div>
        
        <div class="api-grid">
            <div class="section">
                <h2>ğŸ’° ì—¬í–‰ ê²½ë¹„ ê³„ì‚° (ë©”ì¸ ì„œë²„)</h2>
                <input type="text" id="main-destination" placeholder="Destination" value="japan">
                <input type="number" id="main-days" placeholder="Days" value="7">
                <select id="main-budget">
                    <option value="budget">Budget</option>
                    <option value="mid" selected>Mid-range</option>
                    <option value="luxury">Luxury</option>
                </select>
                <input type="number" id="main-travelers" placeholder="Travelers" value="1">
                <button onclick="testMainTravelCost()">ê³„ì‚°í•˜ê¸°</button>
                <div id="main-cost-result" class="result"></div>
            </div>
            
            <div class="section">
                <h2>ğŸ’° ì—¬í–‰ ê²½ë¹„ ê³„ì‚° (ì§ì ‘ API)</h2>
                <input type="text" id="direct-destination" placeholder="Destination" value="japan">
                <input type="number" id="direct-days" placeholder="Days" value="7">
                <select id="direct-budget">
                    <option value="budget">Budget</option>
                    <option value="mid" selected>Mid-range</option>
                    <option value="luxury">Luxury</option>
                </select>
                <input type="number" id="direct-travelers" placeholder="Travelers" value="1">
                <button onclick="testDirectTravelCost()">ê³„ì‚°í•˜ê¸°</button>
                <div id="direct-cost-result" class="result"></div>
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ–ï¸ ì—¬í–‰ì§€ ì •ë³´ ì¡°íšŒ</h2>
            <input type="text" id="dest-info" placeholder="Destination" value="thailand">
            <button onclick="testDestinationInfo()">ì •ë³´ ì¡°íšŒ</button>
            <div id="destination-info-result" class="result"></div>
        </div>
        
        <div class="section">
            <h2>ğŸ†š ì—¬í–‰ì§€ ë¹„êµ</h2>
            <input type="text" id="compare-dest1" placeholder="Destination 1" value="japan">
            <input type="text" id="compare-dest2" placeholder="Destination 2" value="thailand">
            <input type="number" id="compare-days" placeholder="Days" value="7">
            <select id="compare-budget">
                <option value="budget">Budget</option>
                <option value="mid" selected>Mid-range</option>
                <option value="luxury">Luxury</option>
            </select>
            <button onclick="testCompareDestinations()">ë¹„êµí•˜ê¸°</button>
            <div id="compare-result" class="result"></div>
        </div>
        
        <div class="section">
            <h2>ğŸ¤– Gemini ì¶”ì²œ (ì •í™•í•œ ê²½ë¹„ í¬í•¨)</h2>
            <p>ì‹¤ì œ ì—¬í–‰ ì¶”ì²œ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸</p>
            <button onclick="testGeminiRecommendation()">ì—¬í–‰ì§€ ì¶”ì²œ ë°›ê¸°</button>
            <div id="gemini-result" class="result"></div>
        </div>
    </div>

    <script>
        const MAIN_API = 'http://localhost:5005';
        const DIRECT_API = 'http://localhost:3001';

        async function checkTravelCostStatus() {
            try {
                const response = await fetch(`${MAIN_API}/api/travel-cost-status`);
                const data = await response.json();
                const statusClass = data.available ? 'status-ok' : 'status-error';
                document.getElementById('status-result').innerHTML = 
                    `<span class="${statusClass}">Travel Cost API: ${data.message}</span>\nBase URL: ${data.base_url}`;
            } catch (error) {
                document.getElementById('status-result').innerHTML = 
                    `<span class="status-error">ì˜¤ë¥˜: ${error.message}</span>`;
            }
        }

        async function checkMainServerStatus() {
            try {
                const response = await fetch(`${MAIN_API}/api/travel-cost-status`);
                const statusClass = response.ok ? 'status-ok' : 'status-error';
                document.getElementById('status-result').innerHTML += 
                    `\n<span class="${statusClass}">ë©”ì¸ ì„œë²„: ${response.ok ? 'ì •ìƒ' : 'ì˜¤ë¥˜'}</span>`;
            } catch (error) {
                document.getElementById('status-result').innerHTML += 
                    `\n<span class="status-error">ë©”ì¸ ì„œë²„ ì˜¤ë¥˜: ${error.message}</span>`;
            }
        }

        async function testMainTravelCost() {
            try {
                const payload = {
                    destination: document.getElementById('main-destination').value,
                    days: parseInt(document.getElementById('main-days').value),
                    budget_level: document.getElementById('main-budget').value,
                    travelers: parseInt(document.getElementById('main-travelers').value)
                };
                
                const response = await fetch(`${MAIN_API}/api/travel-cost`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const data = await response.json();
                document.getElementById('main-cost-result').innerHTML = 
                    `Status: ${response.status}\n${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                document.getElementById('main-cost-result').innerHTML = 
                    `ì˜¤ë¥˜: ${error.message}`;
            }
        }

        async function testDirectTravelCost() {
            try {
                const payload = {
                    destination: document.getElementById('direct-destination').value,
                    days: parseInt(document.getElementById('direct-days').value),
                    budget_level: document.getElementById('direct-budget').value,
                    travelers: parseInt(document.getElementById('direct-travelers').value)
                };
                
                const response = await fetch(`${DIRECT_API}/api/calculate-cost`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const data = await response.json();
                document.getElementById('direct-cost-result').innerHTML = 
                    `Status: ${response.status}\n${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                document.getElementById('direct-cost-result').innerHTML = 
                    `ì˜¤ë¥˜: ${error.message}`;
            }
        }

        async function testDestinationInfo() {
            try {
                const destination = document.getElementById('dest-info').value;
                const response = await fetch(`${MAIN_API}/api/destination-info/${destination}`);
                const data = await response.json();
                document.getElementById('destination-info-result').innerHTML = 
                    `Status: ${response.status}\n${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                document.getElementById('destination-info-result').innerHTML = 
                    `ì˜¤ë¥˜: ${error.message}`;
            }
        }

        async function testCompareDestinations() {
            try {
                const payload = {
                    destinations: [
                        document.getElementById('compare-dest1').value,
                        document.getElementById('compare-dest2').value
                    ],
                    days: parseInt(document.getElementById('compare-days').value),
                    budget_level: document.getElementById('compare-budget').value
                };
                
                const response = await fetch(`${MAIN_API}/api/compare-destinations`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const data = await response.json();
                document.getElementById('compare-result').innerHTML = 
                    `Status: ${response.status}\n${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                document.getElementById('compare-result').innerHTML = 
                    `ì˜¤ë¥˜: ${error.message}`;
            }
        }

        async function testGeminiRecommendation() {
            try {
                // ìƒ˜í”Œ ì„¤ë¬¸ ë°ì´í„°
                const surveyData = {
                    q0: 'í•´ì™¸ì—¬í–‰',
                    q1: 'ìì—°ê²½ê´€',
                    q2: 'íë§ì—¬í–‰',
                    q4: '100',
                    q4_1: '7',
                    q11: '2'
                };
                
                const response = await fetch(`${MAIN_API}/api/recommend`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(surveyData)
                });
                
                const data = await response.json();
                document.getElementById('gemini-result').innerHTML = 
                    `Status: ${response.status}\n${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                document.getElementById('gemini-result').innerHTML = 
                    `ì˜¤ë¥˜: ${error.message}`;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ìƒíƒœ í™•ì¸
        window.onload = function() {
            checkTravelCostStatus();
        };
    </script>
</body>
</html>
